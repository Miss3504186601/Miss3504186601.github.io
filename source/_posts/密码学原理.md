---
title: 密码学原理
date: 2025-06-03 22:15:43
tags:
  - 密码学
categories:
  - 专业课
keywords:
  - 密码学
description: 作为期末复习资料
cover: https://cdn.jsdelivr.net/gh/Miss3504186601/blog-assets@latest/pictures/305092625a0fca78655e50f012c517c3.jpg
---

# 引言

## 密码学的发展

> 1949年`C.E Shannon`发表`保密系统的通信协议`，为密码学奠定坚实的理论基础
> 1976年`W.Diffe`和`M.E.Hellman`发表`密码学中的新方向`，提出一种崭新的密码设计思想，导致了密码学上的一场革命。

## 保密系统

> 一个保密系统主要由：`明文信源`、`信道`、`加密器`、`解密器`以及`密钥源`五个基本部分组成。

## 密码体制

> 一个密码体制通常由：`明文空间`、`密文空间`、`密钥空间`、`加密算法以及`解密算法`五个基本部分组成。

## 密码分析

> 密码分析就是对密码体制的攻击。

攻击密码体制的方法
- 穷举攻击
- 统计分析攻击
- 解密变换攻击

对密码体制攻击的情况
- 唯密文攻击
- 已知明文攻击
- 选择明文攻击
- 选择密文攻击

## 密码体制的安全性

- 计算安全性
- 可证明安全性
- 无条件安全性

# 古典密码

## 基本加密运算

### 单表加密

|运算|单表密钥量|多表密钥量|
|---|---|---|
|加法|$q$|$q^n$|
|乘法|$\phi(q)$|$\phi(q)^n$|
|仿射|$q\phi(q)$|$q^n\phi(q)^n$|
|置换|$q!$|${q!}^n$|

## 单表加密

- Caeser加密(加法)
- 标准字头

## 多表加密

- Playfair加密
  - 26字母构造$5x5$矩阵,i、j同一个。插入字母，够成为偶数
  - 明文两两分组
  - 三种情况对应密文
- Vigenère加密
  - $c_i\ =\ m_i\ +\ k_i\ mod\ 26$
- Vernam加密
  - $c_i\ =\ m_i\ xor\ k_i$
- Hill加密
  - 矩阵乘法

## 频率分析

- 单表
- 多表
  - 确定密钥长度
    - Kasiski测试
    - 重合指数法
  - 破译

# Shannon理论

## 信息熵

### 信息熵的定义

熵
$H(X)=-\sum_{i=1}^{n}Pr(x_i)\log_2Pr(x_i)$

联合熵
$H(X,Y)=-\sum_{i=1}^{n}\sum_{j=1}^{m}Pr(x_i,y_j)\log_2Pr(x_i,y_j)$

条件熵
$H(X|Y)=-\sum_{i=1}^{n}\sum_{j=1}^{m}Pr(y_j)Pr(x_i|y_j)\log_2Pr(x_i|y_j)$

### 信息熵的性质

$0\ \leqslant H(X)\leqslant \log_2n$

$H(X,Y)\leqslant H(X)+H(Y)$

$H(X,Y)=H(Y)+H(X|Y)=H(Y)+H(X,Y)-H(Y,X)$

$H(X|Y)\leqslant H(X)$

## 伪密钥与唯一解距离

### 伪密钥

> 伪密钥: 得到的密钥有很多，只有一个是正确的，其他可能的密钥是伪密钥。

### 唯一解距离

> 唯一解距离: 使得伪密钥期望为0的密文长度$n_0$.

## 完善保密性

$Pr(x|y)\ =\ Pr(x)$

Vernam体制S具有完善保密性

# 分组密码

分组密码又称为对称密码

## 基本原理

- 扩散：明文影响密文的分布
- 混淆：明文与密文的关系

## 结构

### Feistel网络

DES使用

#### 平衡Feistel网络

#### 非平衡Feistel网络

### SP网络

AES使用

## DES

- 分组长度：64bit
- 密钥长度：64bit，56bit为有效位，8位为校验位

### 加密过程

- 初始置换IP
- 16轮迭代
  - 子密钥生成
    - 去除8位
    - 移位
    - 重排
  - 函数F
    - 位扩展
    - 与密钥异或
    - S盒
- 逆初始置换IP^-1

### 安全性

只有S盒非线性变换，是DES关键

## AES

分组长度：128bit
密钥长度：128bit，192bit，256bit
圈数：10轮，12轮，14轮

### 加密过程

- 字节代换
- 行移位
- 列混淆
- 轮密钥生成

## 工作模式

### DES

- 电子密码本模式ECB
- 密码分组链接模式CBC
- 密码反馈模式CFB
- 输出反馈模式OFB

### AES

- 电子密码本模式ECB
- 密码分组链接模式CBC
- 密码反馈模式CFB
- 输出反馈模式OFB
- 计数器模式CTR

# 公钥密码

公钥密码又称为非对称密码

## 数学基础

### 中国剩余定理

$$
x\ \equiv\ a_i\ (mod\ m_i)
$$

$$
x\ \equiv\ \sum_{i=1}^{n}a_iM_iy_i\ (mod\ M_i)\ M\ = \prod_{i=1}^{n}m_i,\ M_i\ = M / m_i,\ y_i\ =\ M_i^{-1}\ (mod\ m_i)
$$

### Euler函数

1. **积性函数**：如果 $\gcd(m, n) = 1$，则 $\phi(mn) = \phi(m)\phi(n)$。
2. **素数幂**：对于素数 $p$ 和正整数 $k$，
   $$
   \phi(p^k) = p^k - p^{k-1} = p^k \left(1 - \frac{1}{p}\right)
   $$
3. **一般公式**：如果 \(n\) 的质因数分解为 \(n = p_1^{k_1} p_2^{k_2} \cdots p_m^{k_m}\)，则
   $$
   \phi(n) = n \prod_{i=1}^m \left(1 - \frac{1}{p_i}\right)
   $$

### Euler定理与Fermat定理

如果$\gcd(a, n) = 1$则：
$$
a^{\phi(n)} \equiv 1 \pmod{n}
$$


如果 \(p\) 是素数，且 \(\gcd(a, p) = 1\)，则：
$$
a^{p-1} \equiv 1 \pmod{p}
$$

## RSA

### 安全性

大整数素分解问题的难解性

### 加密过程

- 选择两个大素数$p,q$不公开
- 计算$n=pq，\phi(n)=(p-1)(q-1)$，n公开，$\phi(n)$不公开
- 计算$e$，$1<e<\phi(n)$， $gcd(e，\phi(n))=1$，$e$公开
- 计算$d$，$ed\equiv 1\pmod{\phi(n)}$，$d$不公开
- 加密：$c=m^e\pmod{n}$
- 解密：$m=c^d\pmod{n}$

## 模n求逆

## EIGamal

### 安全性

有限域$Z_p$上的离散对数问题的难解性

### 加密过程

- 选择大素数$p$，$\alpha$为$Z_p$的本原元，均公开
- 选择$d$, $1<d<p-2$，$d$不公开; $\beta=\alpha^d\pmod{p}$,加密密钥，公开
- 选择$k$，$1<k<p-2$，$k$不公开
  - 加密：$c=(c_1,\ c_2)$
  - $c_1=\alpha^k\pmod{p}$
  - $c_2=m\beta^k\pmod{p}$
- 解密：$m=c_2(c_1^d)^{-1}mod{p}$

## Menezes-Vanstone公钥密码

### 安全性

椭圆曲线上的离散对数问题的难解性

### 椭圆曲线加法公式

#### 椭圆曲线定义
在仿射坐标系下，椭圆曲线的方程为： 
$$
E: y^2 = x^3 + a x + b \quad ( 4a^3 + 27b^2 \neq 0)
$$

#### 加法规则
设 $P = (x_1, y_1)$ 和 $Q = (x_2, y_2)$ 是椭圆曲线上的点，计算 $P + Q = R = (x_3, y_3)$ 的规则如下：

$$
P + Q = 
\begin{cases}
\mathcal{O} & \text{如果 } P = -Q \text{（即 } x_1 = x_2 \text{ 且 } y_1 = -y_2\text{）}, \\
2P & \text{如果 } P = Q \text{（倍点运算）}, \\
\text{一般加法} & \text{否则}.
\end{cases}
$$


##### (1) \(P = -Q\)（结果为无穷远点）
$$
P + Q = \mathcal{O}
$$

##### (2) \(P = Q\)（倍点运算）
$$
m = \frac{3x_1^2 + a}{2y_1} \pmod{p}, \\
x_3 = m^2 - 2x_1 \pmod{p}, \\
y_3 = m(x_1 - x_3) - y_1 \pmod{p}.
$$

##### (3) 一般情况（$P \neq Q$ 且 $P \neq -Q$）
$$
m = \frac{y_2 - y_1}{x_2 - x_1} \pmod{p}, \\
x_3 = m^2 - x_1 - x_2 \pmod{p}, \\
y_3 = m(x_1 - x_3) - y_1 \pmod{p}.
$$

#### 3. 无穷远点 $\mathcal{O}$ 的性质
- 单位元：
  $$
  P + \mathcal{O} = \mathcal{O} + P = P
  $$
- 逆元：
  $$
  -P = (x_1, -y_1), \quad P + (-P) = \mathcal{O}
  $$